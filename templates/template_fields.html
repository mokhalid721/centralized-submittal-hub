{% extends "base.html" %}
{% block content %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <div>
    <h2 class="mb-0">Configure Fields</h2>
    <div class="text-muted">{{ project.name }} Â· {{ template.name }} ({{ template.template_type }})</div>
  </div>
  <a class="btn btn-outline-secondary" href="{{ url_for('template_list', project_id=project.id) }}">Back</a>
</div>

<div class="card p-3">
  <form method="post">
    <div class="table-responsive">
      <table class="table table-sm align-middle">
        <thead>
          <tr>
            <th style="width: 18%;">Key</th>
            <th style="width: 18%;">Label</th>
            <th style="width: 12%;">Type</th>
            <th style="width: 16%;">Formatter</th>
            <th style="width: 20%;">Dropdown Options (1/line)</th>
            <th style="width: 6%;">Req</th>
            <th style="width: 8%;">Order</th>
          </tr>
        </thead>
        <tbody>
          {% for f in fields %}
            <tr>
              <td class="mono">{{ f.key }}</td>
              <td><input class="form-control form-control-sm" name="label_{{ f.id }}" value="{{ f.label }}"></td>
              <td>
                <select class="form-select form-select-sm" name="type_{{ f.id }}">
                  <option value="text" {% if f.field_type=="text" %}selected{% endif %}>Text</option>
                  <option value="textarea" {% if f.field_type=="textarea" %}selected{% endif %}>Multiline</option>
                  <option value="date" {% if f.field_type=="date" %}selected{% endif %}>Date</option>
                  <option value="select" {% if f.field_type=="select" %}selected{% endif %}>Dropdown</option>
                </select>
              </td>
              <td>
                <select class="form-select form-select-sm" name="formatter_{{ f.id }}">
                  <option value="" {% if f.formatter=="" %}selected{% endif %}>None</option>
                  <option value="date" {% if f.formatter=="date" %}selected{% endif %}>Date</option>
                  <option value="name" {% if f.formatter=="name" %}selected{% endif %}>Name</option>
                </select>
              </td>
              <td><textarea class="form-control form-control-sm" name="options_{{ f.id }}" rows="2">{{ f.options_text }}</textarea></td>
              <td class="text-center"><input class="form-check-input" type="checkbox" name="required_{{ f.id }}" {% if f.required %}checked{% endif %}></td>
              <td><input class="form-control form-control-sm" type="number" name="order_{{ f.id }}" value="{{ f.order_index }}"></td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="d-flex gap-2 justify-content-end">
      <button class="btn btn-primary">Save</button>
    </div>
  </form>
</div>
{% endblock %}
